%%
%% Some pre-defined texgit format commands.
%
%% Place a listing with data from texgit.
%% #1 the label (must put prefix manually!)
%% #2 the caption
%% #3 the style and formatting commands to use
\protected\gdef\listingBox#1#2#3{%
\begin{figure}[tb]%
\centering%
\edef\@lb@caption{}%
\edef\@lb@url{\gitUrl{#1}}%
\ifx\@lb@url\empty\relax\else%
\ifx\@lb@url\@texgit@dummyUrl\relax\else%
\def\@lb@caption{~(\expandafter\href{\@lb@url}{src})}%
\fi\fi%
\lstinputlisting[label={#1}#3,caption={#2\@lb@caption}]{\gitFile{#1}}%
\end{figure}%
}%
%
%% Place a Python listing with data from texgit.
%% #1 the label (lst: is prepended)
%% #2 the caption
\protected\gdef\listingPython#1#2{%
\listingBox{lst:#1}{#2}{,style=python_style}%
}%
%
%% Place a Bash listing with data from texgit.
%% #1 the label (lst: is prepended)
%% #2 the caption
\protected\gdef\listingBash#1#2{%
\listingBox{lst:#1}{#2}{,style=bash_style}%
}%
%
%% Place a Bat listing with data from texgit.
%% #1 the label (lst: is prepended)
%% #2 the caption
\protected\gdef\listingBat#1#2{%
\listingBox{lst:#1}{#2}{,style=bat_style}%
}%
%
%% Place a txt listing with data from texgit.
%% #1 the label (lst: is prepended)
%% #2 the caption
\protected\gdef\listingTxt#1#2{%
\listingBox{lst:#1}{#2}{,style=text_style}%
}%
%
%% Place a SQL listing with data from texgit.
%% #1 the label (lst: is prepended)
%% #2 the caption
\protected\gdef\listingSQL#1#2{%
\listingBox{lst:#1}{#2}{,style=sql_style}%
}%
%
%% Place a txt listing with data from texgit.
%% #1 the label (exec: is prepended)
%% #2 the caption
\protected\gdef\listingToolOutput#1#2{%
\listingBox{exec:#1}{#2}{,style=tool_style}%
}%
%
%
%% Place a listing with data from texgit.
%% #1 the label
%% #2 the caption of the source listing
%% #3 the caption of the output listing
%% #4 the style and formatting commands to use for the first listing
%% #5 the style and formatting commands to use for the second listing
%% #6 the separator if any
%%
\protected\gdef\listingDoubleBox#1#2#3#4#5#6{%
\begin{figure}[tb]%
\centering%
%
\lstinputlisting[label={lst:#1}#4,caption={#2}]{\gitFile{lst:#1}}%
#6%
\edef\@ldb@outputFmt{#5}%
\ifx\@ldb@outputFmt\empty\expandafter\@firstoftwo\else\expandafter\@secondoftwo\fi%
{\lstinputlisting[label={exec:#1},style=text_style,caption={#3}]{\gitFile{exec:#1}}}%
{\lstinputlisting[label={exec:#1}#5,caption={#3}]{\gitFile{exec:#1}}}%
\end{figure}%
}%
%
%
%% Place a Python listing with output.
%% #1 the label
%% #2 the name of the source file
%% #3 the caption
%% #4 the format of the output data
%%
\protected\gdef\listingPythonAndOutput#1#2#3#4{%
\listingDoubleBox{#1}{%
#3~(stored in file~\programUrl{#1}{#2}; output in~\cref{exec:#1})%
}{\captionStdout{#1}{#2}}{,style=python_style}{#4}{%
\listingSepPython{#2}%
}%
}%
%
%
%% Place a Python listing with error output.
%% #1 the label
%% #2 the name of the source file
%% #3 the caption
%%
\protected\gdef\listingPythonAndError#1#2#3{%
\listingDoubleBox{#1}{%
#3~(stored in file~\programUrl{#1}{#2}; output in~\cref{exec:#1})%
}{\captionStdall{#1}{#2}}{,style=python_style}{,style=text_style}{%
\listingSepPython{#2}%
}%
}%
%
%
%% Place a Bash listing with output.
%% #1 the label
%% #2 the name of the source file
%% #3 the caption
%% #4 the format of the output data
%%
\protected\gdef\listingBashAndOutput#1#2#3#4{%
\listingDoubleBox{#1}{%
#3~(stored in file~\programUrl{#1}{#2}; output in~\cref{exec:#1})%
}{%
\captionStdout{#1}{#2}%
}{,style=bash_style}{#4}{%
\listingSepBash{#2}%
}%
}%
%
%
%% Place a Python listing with output.
%% #1 the label
%% #2 the name of the source file
%% #3 the caption
%% #4 the format of the output data
%%
\protected\gdef\listingSQLandOutput#1#2#3#4{%
\edef\@lb@saos{#4}%
\ifx\@lb@saos\empty\expandafter\@firstoftwo\else\expandafter\@secondoftwo\fi%
{\listingDoubleBox{#1}{%
#3~(stored in file~\programUrl{#1}{#2}; output in~\cref{exec:#1})%
}{\captionStdout{#1}{#2}}{,style=sql_style}{,style=tool_style_sql}{%
\medskip%
}}%
{\listingDoubleBox{#1}{%
#3~(stored in file~\programUrl{#1}{#2}; output in~\cref{exec:#1})%
}{\captionStdout{#1}{#2}}{,style=sql_style}{#4}{%
\medskip%
}}%
}%
